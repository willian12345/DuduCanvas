function ownKeys(e,t){var i,r=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)),r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach(function(t){_defineProperty(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _construct(t,e,i){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,i){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return i&&_setPrototypeOf(r,i.prototype),r}).apply(null,arguments)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _createSuper(i){var r=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(i);return _possibleConstructorReturn(this,r?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _get(t,e,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){t=_superPropBase(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(i):e.value}})(t,e,i||t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _iterableToArrayLimit(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,n,s=[],a=!0,h=!1;try{for(i=i.call(t);!(a=(r=i.next()).done)&&(s.push(r.value),!e||s.length!==e);a=!0);}catch(t){h=!0,n=t}finally{try{a||null==i.return||i.return()}finally{if(h)throw n}}return s}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(i="Object"===i&&t.constructor?t.constructor.name:i)||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,n=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw n}}}}var draw=Symbol("draw"),drawImage$1=Symbol("drawImage"),getAlpha=Symbol("getAlpha"),append=Symbol("append"),instructions=Symbol("instructions"),drawGraphics=Symbol("drawGraphics");function getPrefix(){var t="";return"undefined"!=typeof uni?t=uni:"undefined"!=typeof wx?t=wx:"undefined"!=typeof my?t=my:"undefined"!=typeof tt&&(t=tt),t}var prefix=getPrefix(),getImageInfo=prefix.getImageInfo,createSelectorQuery=prefix.createSelectorQuery,createCanvasContext=prefix.createCanvasContext,total=Symbol("total"),loaded=Symbol("loaded"),load=Symbol("load"),loadProgressCallback=Symbol("loadProgressCallback"),imageMap=Symbol("imageMap"),PATH_REG=/^http*/,ImgLoader=function(){function r(e,t){var i=this;return _classCallCheck(this,r),this[total]=e.length,this[loaded]=0,this[t]=t,this[imageMap]=new Map,new Promise(function(t){i[load](e,t)})}return _createClass(r,[{key:"get",value:function(t){return this[imageMap].get(t)}},{key:load,value:function(t,i){var r=this;return t.forEach(function(e){getImageInfo({src:e.src,success:function(t){PATH_REG.test(e.src)||(t.path="/"+t.path),r[imageMap].set(e.id,{path:t.path,width:t.width,height:t.height}),r[loaded]++,r[loadProgressCallback]&&r[loadProgressCallback](p),1<=r[loaded]/r[total]&&i(r)}})}),this}}]),r}();function getPosAfterRotation(t,e,i){t*=Math.PI/180;return{x:Math.cos(t)*e-Math.sin(t)*i,y:Math.cos(t)*i+Math.sin(t)*e}}function getMaxValue(t){for(var e=t[0].x,i=t[0].x,r=t[0].y,n=t[0].y,s=1,a=t.length;s<a;s++)e>t[s].x&&(e=t[s].x),t[s].x>i&&(i=t[s].x),r>t[s].y&&(r=t[s].y),t[s].y>n&&(n=t[s].y);return[e,r,i,n]}function findNodes(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=t.childs.length;if(i)for(var r=0;r<i;r++){if(t.childs[r].childs&&t.childs[r].childs.length){var n=findNodes(t.childs[r]);return e.push(t.childs[r]),e.concat(n)}e.push(t.childs[r])}else e.push(t);return e}var BeginPath=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"exec",value:function(t){t.beginPath()}}]),t}(),MoveTo=function(){function i(t,e){_classCallCheck(this,i),this.x=t,this.y=e}return _createClass(i,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1];t.moveTo(this.x+e,this.y+i)}}]),i}(),LineTo=function(){function i(t,e){_classCallCheck(this,i),this.x=t,this.y=e}return _createClass(i,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1];t.lineTo(this.x+e,this.y+i)}}]),i}(),Arc=function(){function a(t,e,i,r,n,s){_classCallCheck(this,a),this.x=t,this.y=e,this.radius=i,this.startAngle=r,this.endAngle=n,this.anticlockwise=s}return _createClass(a,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1];t.arc(this.x+e,this.y+i,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}}]),a}(),ArcTo=function(){function s(t,e,i,r,n){_classCallCheck(this,s),this.x1=t,this.y1=e,this.x2=i,this.y2=r,this.radius=n}return _createClass(s,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1];t.arcTo(this.x1+e,this.y1+i,this.x2+e,this.y2+i,this.radius)}}]),s}(),Stroke=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"exec",value:function(t){t.stroke()}}]),t}(),Fill=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"exec",value:function(t){t.fill()}}]),t}(),SetFillStyle$1=function(){function e(t){_classCallCheck(this,e),this.style=t}return _createClass(e,[{key:"exec",value:function(t,e){"CreateLinearGradient"===this.style.name||"CreateRadialGradient"===this.style.name?t.fillStyle=this.style.exec(t,e):t.fillStyle=this.style}}]),e}(),SetStrokeStyle=function(){function e(t){_classCallCheck(this,e),this.style=t}return _createClass(e,[{key:"exec",value:function(t){t.strokeStyle=this.style}}]),e}(),Clip=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"exec",value:function(t){t.clip()}}]),t}(),QuadraticCurveTo=function(){function n(t,e,i,r){_classCallCheck(this,n),this.cpx=t,this.cpy=e,this.x=i,this.y=r}return _createClass(n,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1];t.quadraticCurveTo(this.cpx+e,this.cpy+i,this.x+e,this.y+i)}}]),n}(),BezierCurveTo=function(){function a(t,e,i,r,n,s){_classCallCheck(this,a),this.cp1x=t,this.cp1y=e,this.cp2x=i,this.cp2y=r,this.x=n,this.y=s}return _createClass(a,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1];t.bezierCurveTo(this.cp1x+e,this.cp1y+i,this.cp2x+e,this.cp2y+i,this.x+e,this.y+i)}}]),a}(),DrawCircle=function(){function n(t,e,i){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,n),this.x=t,this.y=e,this.radius=i,this.fill=r}return _createClass(n,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),r=i[0],i=i[1];t.beginPath(),t.arc(this.x+r,this.y+i,this.radius,0,2*Math.PI),e.isMask?t.clip():this.fill&&t.fill()}}]),n}(),Rect=function(){function s(t,e,i,r){var n=4<arguments.length&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,s),this.x=t,this.y=e,this.w=i,this.h=r,this.isStroke=n}return _createClass(s,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),r=i[0],i=i[1],r=this.x+r,i=this.y+i;t.beginPath(),e.isMask?(t.rect(r,i,this.w,this.h),t.clip()):this.isStroke?t.strokeRect(r,i,this.w,this.h):t.fillRect(r,i,this.w,this.h)}}]),s}(),RoundRect=function(){function l(t,e,i,r,n,s,a){_classCallCheck(this,l),this.stroke=void 0===a||a,void 0===n&&(n=5),this.x=t,this.y=e,this.width=i,this.height=r,this.fill=s;var h,o=n="number"==typeof n?{tl:n,tr:n,br:n,bl:n}:n;for(h in this.radius={},o)this.radius[h]=this.radius[h]||o[h]}return _createClass(l,[{key:"exec",value:function(t,e){var i,r=_slicedToArray(e.getPosition(),2),n=r[0],s=r[1],a=n+this.x,h=s+this.y,o=this.radius,r=this.width,n=this.height,s=e.masked?i=!1:(i=this.fill,this.stroke);t.beginPath(),t.moveTo(a+o.tl,h),t.lineTo(a+r-o.tr,h),t.quadraticCurveTo(a+r,h,a+r,h+o.tr),t.lineTo(a+r,h+n-o.br),t.quadraticCurveTo(a+r,h+n,a+r-o.br,h+n),t.lineTo(a+o.bl,h+n),t.quadraticCurveTo(a,h+n,a,h+n-o.bl),t.lineTo(a,h+o.tl),t.quadraticCurveTo(a,h,a+o.tl,h),t.closePath(),e.isMask?t.clip():(i&&t.fill(),s&&t.stroke())}}]),l}(),ClearRect=function(){function n(t,e,i,r){_classCallCheck(this,n),this.x=t,this.y=e,this.w=i,this.h=r}return _createClass(n,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1];t.clearRect(this.x+e,this.y+i,this.w,this.h)}}]),n}(),LineCap=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"butt";_classCallCheck(this,e),this.lineCap=t}return _createClass(e,[{key:"exec",value:function(t,e){t.lineCap=this.lineCap}}]),e}(),LineJoin=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"bevel",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10;_classCallCheck(this,i),this.lineJoin=t,this.miterLimit=e}return _createClass(i,[{key:"exec",value:function(t){10!=this.miterLimit&&"bevel"===this.style&&(t.miterLimit=this.miterLimit),t.lineJoin=this.lineJoin}}]),i}(),LineWidth=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;_classCallCheck(this,e),this.lineWidth=t}return _createClass(e,[{key:"exec",value:function(t,e){t.lineWidth=this.lineWidth}}]),e}(),SetLineDash=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.lineDash=t}return _createClass(e,[{key:"exec",value:function(t,e){t.setLineDash(this.lineDash)}}]),e}(),Graphics=function(){function t(){var a=this;_classCallCheck(this,t),_defineProperty(this,"name","Graphics"),_defineProperty(this,"graphics",{beginPath:function(){return a[append](new BeginPath),a.graphics},moveTo:function(t,e){return a[append](new MoveTo(t,e)),a.graphics},setLineDash:function(t){return a[append](new SetLineDash(t)),a.graphics},lineWidth:function(t){return a[append](new LineWidth(t)),a.graphics},lineCap:function(t){return a[append](new LineCap(t)),a.graphics},lineJoin:function(t){return a[append](new LineJoin(t)),a.graphics},lineTo:function(t,e){return a[append](new LineTo(t,e)),a.graphics},quadraticCurveTo:function(t,e,i,r){return a[append](new QuadraticCurveTo(t,e,i,r)),a.graphics},bezierCurveTo:function(t,e,i,r,n,s){return a[append](new BezierCurveTo(t,e,i,r,n,s)),a.graphics},arc:function(t,e,i,r,n){return a[append](new Arc(t,e,i,r,n,5<arguments.length&&void 0!==arguments[5]&&arguments[5])),a.graphics},arcTo:function(t,e,i,r,n){return a[append](new ArcTo(t,e,i,r,n)),a.graphics},stroke:function(){return a[append](new Stroke),a.graphics},fill:function(){return a[append](new Fill),a.graphics},fillStyle:function(t){return a[append](new SetFillStyle$1(t)),a.graphics},strokeStyle:function(t){return a[append](new SetStrokeStyle(t)),a.graphics},fillCircle:function(){return a[append](new DrawCircle(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:20,!0)),a.graphics},strokeCircle:function(){return a[append](new DrawCircle(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:20)),a[append](new Stroke),a.graphics},fillRect:function(){return a[append](new Rect(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,3<arguments.length&&void 0!==arguments[3]?arguments[3]:20)),a.graphics},strokeRect:function(){return a[append](new Rect(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,3<arguments.length&&void 0!==arguments[3]?arguments[3]:20,!0)),a[append](new Stroke),a.graphics},fillRoundRect:function(){return a[append](new RoundRect(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,3<arguments.length&&void 0!==arguments[3]?arguments[3]:10,4<arguments.length&&void 0!==arguments[4]?arguments[4]:8,5<arguments.length?arguments[5]:void 0,6<arguments.length?arguments[6]:void 0)),a.graphics},strokeRoundRect:function(t,e,i,r,n){return a[append](new RoundRect(t,e,i,r,n,!1,!0)),a[append](new Stroke),a.graphics},clearRect:function(t,e,i,r){return a[append](new ClearRect(t,e,i,r)),a.graphics},clip:function(){return a[append](new Clip),a.graphics}}),this[instructions]=[]}return _createClass(t,[{key:append,value:function(t){this[instructions].push(t)}},{key:drawGraphics,value:function(e){var i=this;this[instructions].forEach(function(t){t.exec(e,i)})}}]),t}(),context=null,displayObjectId=0,id=Symbol("id"),scale=Symbol("scale"),mask=Symbol("mask"),setShadow=Symbol("setShadow"),DisplayObject=function(){_inherits(l,Graphics);var i=_createSuper(l);function l(){var t,e;return _classCallCheck(this,l),_defineProperty(_assertThisInitialized(e=i.call(this)),"name","DisplayObject"),_defineProperty(_assertThisInitialized(e),"x",0),_defineProperty(_assertThisInitialized(e),"y",0),_defineProperty(_assertThisInitialized(e),"width",0),_defineProperty(_assertThisInitialized(e),"height",0),_defineProperty(_assertThisInitialized(e),"alpha",1),_defineProperty(_assertThisInitialized(e),"regX",0),_defineProperty(_assertThisInitialized(e),"regY",0),_defineProperty(_assertThisInitialized(e),"scaleX",1),_defineProperty(_assertThisInitialized(e),"scaleY",1),_defineProperty(_assertThisInitialized(e),"rotation",0),_defineProperty(_assertThisInitialized(e),"parent",null),_defineProperty(_assertThisInitialized(e),"childs",[]),_defineProperty(_assertThisInitialized(e),"shadow",""),e[drawGraphics]=_get((t=_assertThisInitialized(e),_getPrototypeOf(l.prototype)),drawGraphics,t),e[scale]=1,e[id]=displayObjectId++,e}return _createClass(l,[{key:"mask",get:function(){return this[mask]},set:function(t){if("Shape"!==t.name)throw new Error("遮罩必须是 Shape 对象");t.isMask=!0,this[mask]=t}},{key:"scale",get:function(){return this[scale]},set:function(t){this.scaleX=t,this.scaleY=t,this[scale]=t}},{key:"addChild",value:function(){for(var i=this,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e.map(function(t,e){if(t[id]===i[id])throw new Error("不能自己添加自己为 child :".concat(t.name));if(t.isMask)throw new Error("已被设置成 mask 遮罩 不能 addChild 到其它父级内:".concat(t.name));return t.mask&&(t.mask.parent=i),t.parent=i,t.zIndex=e,t});this.childs=this.childs.concat(n)}},{key:"removeChild",value:function(e){this.childs=this.childs.filter(function(t){return t[id]!=e[id]})}},{key:draw,value:function(){var e=this;this[drawGraphics](context),this.childs.forEach(function(t){context.save(),e.transform(t,context),t.shadow.length&&e[setShadow](t),context.globalAlpha=e[getAlpha](),context.rotate(0),t[draw](context),context.restore()})}},{key:setShadow,value:function(t){var e=t.shadow.split(" ");if("Sprite"===t.name||"Group"===t.name)throw new Error("Sprite 或 Group 组件对象不允许设置 shadow");if(e.length<4)throw new Error('shadow 需要 4 个值 eg: "10 10 10 black"');context.shadowOffsetX=e[0],context.shadowOffsetY=e[1],context.shadowBlur=e[2],context.shadowColor=e[3]}},{key:getAlpha,value:function(){for(var t=this.parent,e=this.alpha;t&&"Stage"!=t.name;)e*=t.alpha,t=t.parent;return e}},{key:"getPosition",value:function(){for(var t=this.masked||this.parent,e=this.x-this.regX,i=this.y-this.regY;t&&"Stage"!=t.name;)e+=t.x-t.regX,i+=t.y-t.regY,t=t.parent;return[e,i]}},{key:"getRotation",value:function(){return this.rotation}},{key:"getScale",value:function(){for(var t=this.parent,e=this.scaleX,i=this.scaleY;t&&"Stage"!=t.name;)e+=t.scaleX,i+=t.scaleY,t=t.parent;return[e,i]}},{key:"transform",value:function(t,e){if("Stage"!==t.name){var i=e,r=_slicedToArray(t.getPosition(),2),n=r[0],s=r[1],a=t.getRotation(),e=[t.scaleX,t.scaleY],r=e[0],e=e[1],n=n+t.regX,t=s+t.regY;return i.translate(n,t),i.scale(r,e),i.rotate(a*Math.PI/180),i.translate(-n,-t),this}}},{key:"getRectangleRotatedPosition",value:function(t,e,i,r,n){return[getPosAfterRotation(t,-r,-n),getPosAfterRotation(t,e-r,-n),getPosAfterRotation(t,e-r,i-n),getPosAfterRotation(t,-r,i-n)]}},{key:"_getBounds",value:function(){var t,e,i=_slicedToArray(this.getPosition(),2),r=i[0],n=i[1],s=this.width,a=this.height,h=this.regX,o=this.regY;return 0!==this.rotation&&((e=this.getRectangleRotatedPosition(this.rotation,s,a,h,o)).map(function(t){return _objectSpread2(_objectSpread2({},t),{},{x:t.x+r+h,y:t.y+n+o})}),i=(t=_slicedToArray(getMaxValue(e),4))[0],e=t[1],s=t[2]-i,a=t[3]-e,r=i,n=e),{left:r,top:n,right:r+s,bottom:n+a,width:s,height:a}}},{key:"findNodesBounds",value:function(t){return findNodes(t).map(function(t){return t._getBounds()})}},{key:"getBounds",value:function(){if(0===this.childs.length)return this._getBounds();if(this.childs){var t=this.findNodesBounds(this),e=[],i=[],r=[],n=[];t.forEach(function(t){e.push(t.left),i.push(t.right),r.push(t.top),n.push(t.bottom)});var s=Math.min.apply(Math,e),a=Math.max.apply(Math,i),h=Math.min.apply(Math,r),o=Math.max.apply(Math,n);if("Group"!==this.name)return{left:s,top:h,right:a,bottom:o,width:a-s,height:o-h};t=new l;return t.width=a-s,t.height=o-h,t.x=this.x,t.y=this.y,t.regX=this.regX,t.regY=this.regY,t.rotation=this.rotation,this._getBounds.call(t)}}}],[{key:"setContext",value:function(t){context=t}},{key:"getContext",value:function(){return context}}]),l}(),_width$2=Symbol("width"),_height$2=Symbol("height"),_display=Symbol("_display"),_alignItems$1=Symbol("_alignItems"),_justifyContent$1=Symbol("_justifyContent"),Group=function(){_inherits(r,DisplayObject);var i=_createSuper(r);function r(t){var e;return _classCallCheck(this,r),_defineProperty(_assertThisInitialized(e=i.call(this)),"name","Group"),e}return _createClass(r,[{key:"width",get:function(){return this[_width$2]},set:function(t){this[_width$2]=t}},{key:"height",get:function(){return this[_height$2]},set:function(t){this[_height$2]=t}},{key:"display",get:function(){return this[_display]},set:function(t){this[_display]=t}},{key:"alignItems",get:function(){return this[_alignItems$1]},set:function(t){this[_alignItems$1]=t}},{key:"justifyContent",get:function(){return this[_justifyContent$1]},set:function(t){this[_justifyContent$1]=t}}]),r}(),render=Symbol("render"),Stage=function(){_inherits(s,DisplayObject);var t=_createSuper(s);function s(e,i,r){var n;return _classCallCheck(this,s),_defineProperty(_assertThisInitialized(n=t.call(this)),"name","Stage"),_defineProperty(_assertThisInitialized(n),"canvas",null),(r?createSelectorQuery().in(r):createSelectorQuery()).select(e).fields({node:!0,size:!0}).exec(function(t){t=t[0];if(!t)throw new Error("无法找到 canvas ");n.width=t.width,n.height=t.height,n._context=createCanvasContext(e.slice(1),r),DisplayObject.setContext(n._context),i(_assertThisInitialized(n),n._context),n[render]()}),n}return _createClass(s,[{key:"getContext",value:function(){return this._context}},{key:"update",value:function(){this[render]()}},{key:render,value:function(){this._context.clearRect(0,0,this.width,this.height),this[draw](),this._context.draw(!1)}}]),s}(),ROTATE_90DEG=1.5707963267948966,NO_ROTATION_RANGE=[[11904,12271],[12352,40959],[44032,55295],[63744,64255],[119552,119647],[131072,195103]];function needRotation(t){var e,i=t.codePointAt(0),r=_createForOfIteratorHelper(NO_ROTATION_RANGE);try{for(r.s();!(e=r.n()).done;){var n=_slicedToArray(e.value,2),s=n[0],a=n[1];if(s<=i&&i<=a)return!1}}catch(t){r.e(t)}finally{r.f()}return!0}var FillText=function(){function r(t,e,i){_classCallCheck(this,r),_defineProperty(this,"instance",null),this.text=t,this.x=e,this.y=i}return _createClass(r,[{key:"exec",value:function(t,e){var i=_slicedToArray((this.instance=e).getPosition(),2),r=i[0],n=i[1];if(t.font=e.font,"vertical-rl"===e.writeMode||"vertical-lr"===e.writeMode)this.vertical(t,r,n);else if(-1<e.wrapWidth)for(var s,a=this.getTextArr(t,e,this.text),h=0,o=a.length;h<o;h++)s=n+h*(e.fontSize+e.lineGap),t.fillText(a[h],r,s);else t.fillText(this.text,r,n)}},{key:"getTextArr",value:function(t,e,i){for(var r,n=e.wrapWidth,s=0,a=0,h=0,o=[];r=i[s];)(h+=t.measureText(r).width)<=n?o[a]?o[a]+=i[s]:o[a]=i[s]:(h=0,a++),s++;return o}},{key:"vertical",value:function(r,n,s){var t=this.text.split(""),e=this.instance.fontSize+this.instance.lineGap,a="vertical-rl"===this.instance.writeMode?-e:e,h=this.instance.fontSize,o=.5*h,l=0,c=0,u=this.instance.wrapHeight;t.map(function(t){var e,i;needRotation(t)?(-1<u&&u+s<l+s+o&&(c+=a,l=0),e=n+c+o,i=s+l+o,r.save(),r.translate(e,i),r.rotate(ROTATE_90DEG),r.translate(-e,-i),r.fillText(t,n+c,s+l),l+=o,r.restore()):(-1<u&&u+s<l+s+h&&(c+=a,l=0),r.fillText(t,n+c,s+l),l+=h)})}}]),r}(),SetFillStyle=function(){function e(t){_classCallCheck(this,e),this.style=t}return _createClass(e,[{key:"exec",value:function(t){t.fillStyle=this.style}}]),e}(),SetTextAlign=function(){function e(t){_classCallCheck(this,e),this.textAlign=t}return _createClass(e,[{key:"exec",value:function(t){t.textAlign=this.textAlign}}]),e}(),SetTextBaseline=function(){function e(t){_classCallCheck(this,e),this.textBaseline=t}return _createClass(e,[{key:"exec",value:function(t){t.textBaseline=this.textBaseline}}]),e}(),_text=Symbol("_text"),_width$1=Symbol("_width"),_height$1=Symbol("_height"),_fontSize=Symbol("_fontSize"),_wrapWidth=Symbol("_wrapWidth"),_wrapHeight=Symbol("_wrapHeight"),_writeMode=Symbol("_writeMode"),defaultFontSize=10,Text=function(){_inherits(n,DisplayObject);var r=_createSuper(n);function n(t){var e,i;return _classCallCheck(this,n),_defineProperty(_assertThisInitialized(i=r.call(this)),"name","Text"),_defineProperty(_assertThisInitialized(i),"lineGap",0),_defineProperty(_assertThisInitialized(i),"font","".concat(defaultFontSize,"px sans-serif")),i[drawGraphics]=_get((e=_assertThisInitialized(i),_getPrototypeOf(n.prototype)),drawGraphics,e),i.init(t),i}return _createClass(n,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.text,i=t.font,r=t.color,t=t.fontSize;this[_writeMode]="",!i||(i=(this.font=i).match(/\d+/)[0])&&(this.fontSize=parseInt(i),this[_height$1]=this.fontSize+this.lineGap),t&&(this.font="".concat(t,"px sans-serif"),this.fontSize=parseInt(t),this[_height$1]=t+this.lineGap),this.fontSize||(this.fontSize=defaultFontSize),r&&(this.color=r),this.textAlign="left",this.textBaseline="top",this[_text]="",e&&(this.text=e)}},{key:"text",get:function(){return this[_text]},set:function(t){t=String(t),this[_text]=t,this.width=this.measureWidth(t,this.fontSize),this.height=this.fontSize}},{key:"width",get:function(){return this[_width$1]},set:function(t){this[_width$1]=t}},{key:"height",get:function(){return this[_height$1]},set:function(t){this[_height$1]=t}},{key:"wrapHeight",get:function(){return this[_wrapHeight]},set:function(t){this[_wrapHeight]=t,this[_height$1]=t,this.initVerticalSize()}},{key:"wrapWidth",get:function(){return this[_wrapWidth]},set:function(t){this[_wrapWidth]=t,this[_width$1]=t,this[_height$1]=this.getHeightByWrapWidth()}},{key:"fontSize",get:function(){return this[_fontSize]},set:function(t){this[_fontSize]=t,this.width=this.measureWidth(this.text,t),this.height=t+this.lineGap}},{key:"writeMode",get:function(){return this[_writeMode]},set:function(t){0<(this[_writeMode]=t).length&&this.initVerticalSize()}},{key:"collectStatus",value:function(){this.fontSize&&(this.font="".concat(this.fontSize,"px sans-serif"),this[_height$1]=this.fontSize+this.lineGap),this.setTextAlign(this.textAlign),this.setTextBaseline(this.textBaseline),this.setFillStyle(this.color),this.fillText(this[_text])}},{key:draw,value:function(t){this.collectStatus(),this[drawGraphics](t),this.mask&&"Shape"===this.mask.name&&(this.mask.masked=this).mask[draw](t,!0)}},{key:"setFillStyle",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"black";return this.color=t,this[append](new SetFillStyle(t)),this}},{key:"fillStyle",value:function(t){return this.setFillStyle(t)}},{key:"fillText",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this[_text]=t,this.x+=e,this.y+=i,this.width=this.measureWidth(this[_text],this.fontSize),this[append](new FillText(t,this.x,this.y)),this}},{key:"setFont",value:function(t){return this.font=t,this}},{key:"setFontSize",value:function(t){return this.fontSize=t,this.font=this.font.replace(/\d+/,t),this}},{key:"setTextBaseline",value:function(t){return this.textBaseline=t,this[append](new SetTextBaseline(t)),this}},{key:"setTextAlign",value:function(t){return this.textAlign=t,this[append](new SetTextAlign(t)),this}},{key:"setlineGap",value:function(t){return this.lineGap=t,this}},{key:"setWrapWidth",value:function(t){return this.wrapWidth=t,this.width=t,this}},{key:"setWrapHeight",value:function(t){return this.wrapHeight=t,this}},{key:"measureWidth",value:function(t,e){return this.writeMode.length?e:DisplayObject.getContext().measureText(t).width*(e/defaultFontSize)}},{key:"initVerticalSize",value:function(){var t,e;this.text.length&&(t=(e=this.getVerticalSize()).width,e=e.height,this[_width$1]=t,this[_height$1]=e)}},{key:"getVerticalSize",value:function(){var i=this.fontSize,r=this.lineGap,n=this.wrapHeight,s=.5*i,a=0,t=0,e=0,h=0,o=[],l=0;return this.text.split("").map(function(t){var e=0,e=needRotation(t)?s+r:i+r;a+=e,n<(h+=e)&&(l++,h=0),o[l]=o[l]||[],o[l].push({text:t,height:e})}),n?(t=n,e=o.length*i+(o.length*r-r)):(e=i,t=a),{width:e,height:t}}},{key:"getHeightByWrapWidth",value:function(){for(var t,e=DisplayObject.getContext(),i=this.wrapWidth,r=this.fontSize,n=this.text,s=0,a=0,h=0,o=[];t=n[s];)(h+=e.measureText(t).width*(r/defaultFontSize))<=i?o[a]?o[a]+=n[s]:o[a]=n[s]:(h=0,a++),s++;return this.height=o.length*r+(o.length*this.lineGap-this.lineGap)}},{key:"addChild",value:function(){throw new Error("不能给 Text 类添加子元素")}}]),n}(),Shape=function(){_inherits(r,DisplayObject);var i=_createSuper(r);function r(){var t,e;return _classCallCheck(this,r),_defineProperty(_assertThisInitialized(e=i.call(this)),"name","Shape"),_defineProperty(_assertThisInitialized(e),"isMask",!1),_defineProperty(_assertThisInitialized(e),"width",0),_defineProperty(_assertThisInitialized(e),"height",0),e[drawGraphics]=_get((t=_assertThisInitialized(e),_getPrototypeOf(r.prototype)),drawGraphics,t),e.graphics.beginPath(),e}return _createClass(r,[{key:draw,value:function(t,e){this.isMask=!!e,t.globalAlpha=this[getAlpha](),this[drawGraphics](t)}},{key:"getBounds",value:function(){return console.error("Shape 不提供getBounds方法"),null}}]),r}(),extendsClassDraw$2=Symbol("extendsClassDraw");function getChangedBorderRadiusValue(t){var e,i={tl:0,tr:0,br:0,bl:0},r=(t=String(t).split(" ").map(function(t){return parseFloat(t)})).length;return 1===r?e=t[0]:2===r?(i.tl=i.br=t[0],i.tr=i.bl=t[1],e=i):3===r?(i.tl=t[0],i.br=t[2],i.tr=i.bl=t[1],e=i):4===r&&(i.tl=t[0],i.tr=t[1],i.br=t[2],i.bl=t[3],e=i),e}var BORDER_STYLES=["solid","dashed"],SimpleCss=function(){_inherits(r,DisplayObject);var i=_createSuper(r);function r(){var t,e;return _classCallCheck(this,r),_defineProperty(_assertThisInitialized(e=i.call(this)),"backgroundColor",""),_defineProperty(_assertThisInitialized(e),"border",""),_defineProperty(_assertThisInitialized(e),"borderTop",""),_defineProperty(_assertThisInitialized(e),"borderRight",""),_defineProperty(_assertThisInitialized(e),"borderBottom",""),_defineProperty(_assertThisInitialized(e),"borderLeft",""),_defineProperty(_assertThisInitialized(e),"borderLeftRound",!1),_defineProperty(_assertThisInitialized(e),"borderRightRound",!1),_defineProperty(_assertThisInitialized(e),"borderRadiusValue",""),e[extendsClassDraw$2]=_get((t=_assertThisInitialized(e),_getPrototypeOf(r.prototype)),draw,t),e}return _createClass(r,[{key:"borderRadius",get:function(){return this.borderRadiusValue},set:function(t){t&&(this.borderRadiusValue="100%"!=t?getChangedBorderRadiusValue(t):t)}},{key:draw,value:function(t){(this.borderRadiusValue||this.borderLeftRound||this.borderRightRound)&&this.initBorderRadiusMask(),this.backgroundColor&&this.initBackgroundColor(),(this.border||this.borderTop||this.borderRight||this.borderBottom||this.borderLeft)&&this.initBorder(),this.mask&&"Shape"===this.mask.name&&(this.mask.masked=this).mask[draw](t,!0),this[extendsClassDraw$2](t)}},{key:"getBorderAttr",value:function(t){var e=_slicedToArray(t.split(" "),3),i=e[0],t=e[1],e=e[2],i=parseFloat(i);return BORDER_STYLES.indexOf(t)<0&&console.warn("不支持的边框样式"),[i,t,e]}},{key:"setBorderStyles",value:function(t,e,i){this.graphics.beginPath(),"dashed"===e&&this.graphics.setLineDash([t,t]),this.graphics.lineWidth(t).strokeStyle(i)}},{key:"getHorizontalRoundRectPath",value:function(t,e){var i=new Shape,r=.5*e;return i.graphics.beginPath().fillStyle("#ff00ff").arc(r,r,r,.5*Math.PI,1.5*Math.PI).lineTo(t-r,0).arc(t-r,r,r,1.5*Math.PI,2.5*Math.PI).lineTo(r,e),i}},{key:"getLeftRoundRectPath",value:function(t,e){var i=new Shape,r=.5*e;return i.graphics.beginPath().arc(r,r,r,.5*Math.PI,1.5*Math.PI).lineTo(t,0).lineTo(t,e).lineTo(r,e),i}},{key:"getRightRoundRectPath",value:function(t,e){var i=new Shape,r=.5*e;return i.graphics.beginPath().moveTo(0,0).lineTo(t-r,0).arc(t-r,r,r,1.5*Math.PI,2.5*Math.PI).lineTo(0,e),i}},{key:"getVerticalRoundRectPath",value:function(t,e){var i=new Shape,r=.5*t;return i.graphics.beginPath().arc(r,r,r,Math.PI,2*Math.PI).lineTo(t,e-r).arc(r,e-r,r,0,Math.PI).lineTo(0,r),i}},{key:"initBorder",value:function(){var t,e,i,r,n;this.border?(t=(r=_slicedToArray(this.getBorderAttr(this.border),3))[0],e=r[1],r=r[2],this.setBorderStyles(t,e,r),e=.5*t,this.borderRadius?("100%"!==this.borderRadius&&this.borderRadius!==this.width||this.width!==this.height?this.borderRadius>=this.height?(i=this.getHorizontalRoundRectPath(this.width,this.height)).graphics.stroke():this.borderRadius>=this.width?(i=this.getVerticalRoundRectPath(this.width,this.height)).graphics.stroke():(i=new Shape).graphics.strokeRoundRect(0,0,this.width,this.height,this.borderRadius):(i=new Shape,r=.5*this.width,i.graphics.strokeCircle(r,r,r)),this.addChild(i)):this.graphics.strokeRect(e,e,this.width-t,this.height-t)):(this.borderTop&&(this.setBorderStyles.apply(this,_toConsumableArray(this.getBorderAttr(this.borderTop))),this.graphics.moveTo(0,0).lineTo(this.width,0).stroke()),this.borderRight&&(this.setBorderStyles.apply(this,_toConsumableArray(this.getBorderAttr(this.borderRight))),this.borderRightRound?(n=.5*this.height,this.graphics.arc(this.width-n,n,n,1.5*Math.PI,2.5*Math.PI)):this.graphics.moveTo(this.width,0).lineTo(this.width,this.height),this.graphics.stroke()),this.borderBottom&&(this.setBorderStyles.apply(this,_toConsumableArray(this.getBorderAttr(this.borderBottom))),this.graphics.moveTo(0,this.height).lineTo(this.width,this.height).stroke()),this.borderLeft&&(this.setBorderStyles.apply(this,_toConsumableArray(this.getBorderAttr(this.borderLeft))),this.borderLeftRound?(n=.5*this.height,this.graphics.arc(n,n,n,.5*Math.PI,1.5*Math.PI)):this.graphics.moveTo(0,0).lineTo(0,this.height),this.graphics.stroke()))}},{key:"initBorderRadiusMask",value:function(){var t,e;"100%"!==this.borderRadiusValue&&this.borderRadiusValue!==this.width||this.width!==this.height?this.borderRadiusValue>=this.height||this.borderRightRadius&&this.borderLeftRadius?(e=this.getHorizontalRoundRectPath(this.width,this.height)).graphics.clip().fill():this.borderRadiusValue>=this.width?(e=this.getVerticalRoundRectPath(this.width,this.height)).graphics.clip().fill():this.borderLeftRound?(e=this.getLeftRoundRectPath(this.width,this.height)).graphics.clip().fill():this.borderRightRound?(e=this.getRightRoundRectPath(this.width,this.height)).graphics.clip().fill():(console.log(this.borderRadiusValue,333),(e=new Shape).graphics.fillRoundRect(0,0,this.width,this.height,this.borderRadiusValue)):(t=.5*this.width,(e=new Shape).graphics.fillCircle(t,t,t)),this.mask=e}},{key:"initBackgroundColor",value:function(){this.graphics.beginPath().fillStyle(this.backgroundColor).fillRect(0,0,this.width,this.height)}}]),r}(),extendsClassDraw$1=Symbol("extendsClassDraw"),Image=function(){_inherits(s,SimpleCss);var n=_createSuper(s);function s(t){var e,i,r;for(r in _classCallCheck(this,s),_defineProperty(_assertThisInitialized(i=n.call(this)),"name","Image"),_defineProperty(_assertThisInitialized(i),"image",null),_defineProperty(_assertThisInitialized(i),"path",""),_defineProperty(_assertThisInitialized(i),"sx",void 0),_defineProperty(_assertThisInitialized(i),"sy",void 0),_defineProperty(_assertThisInitialized(i),"sWidth",void 0),_defineProperty(_assertThisInitialized(i),"sHeight",void 0),_defineProperty(_assertThisInitialized(i),"dx",0),_defineProperty(_assertThisInitialized(i),"dy",0),_defineProperty(_assertThisInitialized(i),"dWidth",void 0),_defineProperty(_assertThisInitialized(i),"dHeight",void 0),i[extendsClassDraw$1]=_get((e=_assertThisInitialized(i),_getPrototypeOf(s.prototype)),draw,e),t)i[r]=t[r];return i.path=i.image.path,i.width?i.dWidth=i.width:i.width=i.dWidth,i.height?i.dHeight=i.height:i.height=i.dHeight,i}return _createClass(s,[{key:drawImage$1,value:function(t,e,i){t.globalAlpha=this[getAlpha](),null!=this.sx?t.drawImage(this.path,this.sx,this.sy,this.sWidth,this.sHeight,e,i,this.dWidth,this.dHeight):null!=this.dWidth?t.drawImage(this.path,e,i,this.dWidth,this.dHeight):t.drawImage(this.path,e,i)}},{key:draw,value:function(e){var t=_slicedToArray(this.getPosition(),2),i=t[0],t=t[1],i=this.dx+i,t=this.dy+t;this[extendsClassDraw$1](e),this[drawImage$1](e,i,t),this.childs.forEach(function(t){t[draw](e)})}}]),s}(),drawImage=Symbol("drawImage"),drawSliced=Symbol("drawSliced"),left=Symbol("left"),top=Symbol("top"),right=Symbol("right"),bottom=Symbol("bottom"),setSlice=Symbol("setSlice"),_sliceBounds=Symbol("_sliceBounds"),Sprite=function(){_inherits(n,Group);var r=_createSuper(n);function n(t,e){var i;return _classCallCheck(this,n),_defineProperty(_assertThisInitialized(i=r.call(this)),"name","Sprite"),_defineProperty(_assertThisInitialized(i),"img",null),_defineProperty(_assertThisInitialized(i),"sliced",!1),t&&(i.img=t),i.parentDraw=_get((t=_assertThisInitialized(i),_getPrototypeOf(n.prototype)),draw,t),e&&i[setSlice](e),i}return _createClass(n,[{key:"sliceBounds",get:function(){return this[_sliceBounds]},set:function(t){this._setSlice(t),this[_sliceBounds]=t}},{key:draw,value:function(e){var i=this,t=_slicedToArray(this.getPosition(),2),r=t[0],t=t[1];this.wRatio=this.width/this.img.width,this.hRatio=this.height/this.img.height,this.enableWidth=(this.width-this[left]-this[right])*this.scaleX,this.enableHeight=(this.height-this[top]-this[bottom])*this.scaleY,this[instructions].forEach(function(t){t.exec(e,i)}),this.sliced?this[drawSliced](e,r,t,this[getAlpha]()):this[drawImage](e,r,t),this.childs.forEach(function(t){t[draw](e)})}},{key:drawImage,value:function(t,e,i){new Image({image:this.img,dx:e,dy:i,dWidth:this.width,dHeight:this.height})[draw](t)}},{key:drawSliced,value:function(e,t,i,r){var n={image:this.img,sx:0,sy:0,sWidth:this[left],sHeight:this[top],dWidth:this[left]*this.scaleX,dHeight:this[top]*this.scaleY,dx:t,dy:i},s={image:this.img,sx:this[left],sy:0,sWidth:this.img.width-this[right]-this[left],sHeight:this[top],dWidth:this.enableWidth,dHeight:this[top]*this.scaleY,dx:this[left]*this.scaleX+t,dy:i},a={image:this.img,sx:this.img.width-this[right],sy:0,sWidth:this[right],sHeight:this[top],dWidth:this[right]*this.scaleX,dHeight:this[top]*this.scaleY,dx:this[left]*this.scaleX+s.dWidth+t,dy:i},h={image:this.img,sx:this.img.width-this[right],sy:this[top],sWidth:this[right],sHeight:this.img.height-this[bottom]-this[top],dWidth:this[right]*this.scaleX,dHeight:this.enableHeight,dx:a.dx,dy:a.dy+this[top]*this.scaleY},o={image:this.img,sx:this.img.width-this[right],sy:this.img.height-this[bottom],sWidth:this[right],sHeight:this[bottom],dWidth:this[right]*this.scaleX,dHeight:this[bottom]*this.scaleY,dx:a.dx-.3,dy:h.dy+h.dHeight},l={image:this.img,sx:this[left],sy:this.img.height-this[bottom],sWidth:this.img.width-this[left]-this[right],sHeight:this[bottom],dWidth:this.enableWidth,dHeight:this[bottom]*this.scaleY,dx:s.dx,dy:h.dy+h.dHeight},t={image:this.img,sx:0,sy:this.img.height-this[bottom],sWidth:this[left],sHeight:this[bottom],dWidth:this[left]*this.scaleX,dHeight:this[bottom]*this.scaleX,dx:n.dx,dy:h.dy+h.dHeight},i={image:this.img,sx:0,sy:this[top],sWidth:this[left],sHeight:this.img.height-this[top]-this[bottom],dWidth:this[left]*this.scaleX,dHeight:this.enableHeight,dx:n.dx,dy:h.dy},n=[n,s,a,h,o,l,t,i,{image:this.img,sx:n.sWidth,sy:n.sHeight,sWidth:s.sWidth,sHeight:i.sHeight,dWidth:this.enableWidth,dHeight:this.enableHeight,dx:n.dx+n.dWidth,dy:n.dy+n.dHeight}];return 0!=this.rotation&&console.error("Sprite 因为旋转后会出现拼接缝隙，在九宫格状态下暂时无法旋转, 待小程序完全支持离屏渲染后修复"),n.forEach(function(t){t=new Image(t);t.alpha=r,t[draw](e)}),this}},{key:"_setSlice",value:function(t){return this.sliced=!0,this[left]=t.left,this[top]=t.top,this[right]=t.right,this[bottom]=t.bottom,this}},{key:"setSlice",value:function(t){return this._setSlice(t)}}]),n}(),_width=Symbol("width"),_height=Symbol("height"),_alignItems=Symbol("_alignItems"),_justifyContent=Symbol("_justifyContent"),_direction=Symbol("_direction"),_flex=Symbol("_flex"),extendsClassDraw=Symbol("extendsClassDraw"),Container=function(){_inherits(n,SimpleCss);var r=_createSuper(n);function n(t){var e,i;return _classCallCheck(this,n),_defineProperty(_assertThisInitialized(i=r.call(this)),"name","Container"),i[extendsClassDraw]=_get((e=_assertThisInitialized(i),_getPrototypeOf(n.prototype)),draw,e),i.direction="row",i.justifyContent="center",i.alignItems="center",i}return _createClass(n,[{key:"width",get:function(){return this[_width]},set:function(t){this[_width]=t}},{key:"height",get:function(){return this[_height]},set:function(t){this[_height]=t}},{key:"flex",get:function(){return this[_flex]},set:function(t){this[_flex]=t}},{key:"direction",get:function(){return this[_direction]},set:function(t){this[_direction]=t}},{key:"alignItems",get:function(){return this[_alignItems]},set:function(t){this[_alignItems]=t}},{key:"justifyContent",get:function(){return this[_justifyContent]},set:function(t){this[_justifyContent]=t}},{key:"getChildsWidth",value:function(){var e=0;return this.childs.forEach(function(t){return e+=t.width}),e}},{key:"getChildsHeight",value:function(){var e=0;return this.childs.forEach(function(t){return e+=t.height}),e}},{key:"getBetweenGapWidth",value:function(t){return(t-this.getChildsWidth())/(this.childs.length-1)}},{key:"getBetweenGapHeight",value:function(t){return(t-this.getChildsHeight())/(this.childs.length-1)}},{key:"getAroundGapWidth",value:function(t){return(t-this.getChildsWidth())/this.childs.length}},{key:"getAroundGapHeight",value:function(t){return(t-this.getChildsHeight())/this.childs.length}},{key:"setRow",value:function(){this.setJustifyContent(),this.setAlignItems()}},{key:"setRowReverse",value:function(){this.setJustifyContent(!0),this.setAlignItems()}},{key:"setAlignItems",value:function(){var t=this.childs,e=this.height;if("center"===this.alignItems)for(var i=0,r=t.length;i<r;i++){var n=t[i];n.y+=.5*e-.5*n.height}else if("flex-start"===this.alignItems)for(var s=0,a=t.length;s<a;s++)t[s].y=0;else if("flex-end"===this.alignItems)for(var h=0,o=t.length;h<o;h++){var l=t[h];l.y+=e-l.height}t.forEach(function(t){"flex-start"===t.alignSelf?t.y=0:"center"===t.alignSelf?t.y=.5*e-.5*t.height:"flex-end"===t.alignSelf&&(t.y=e-t.height)})}},{key:"setJustifyContent",value:function(t){var e=this.width,i=this.childs,r=this.justifyContent;if(t&&(i=this.childs.reverse(),"flex-start"===r?r="flex-end":"flex-end"===r&&(r="flex-start")),"flex-start"===r)for(var n=0;n<i.length;n++){var s=i[n];0<n?s.x+=i[n-1].x+i[n-1].width:s.x=0}else if("flex-end"===r)for(var a=this.getChildsWidth(),h=0;h<i.length;h++){var o=i[h];o.x+=0<h?i[h-1].x+i[h-1].width:e-a}else if("center"===r)for(var l=this.getChildsWidth(),c=0;c<i.length;c++){var u=i[c];u.x+=0<c?i[c-1].x+i[c-1].width:.5*(e-l)}else if("space-between"===r)for(var d=this.getBetweenGapWidth(e),f=0,g=i.length;f<g;f++){var p=i[f];p.x+=0<f?i[f-1].x+i[f-1].width+d:0}else if("space-around"===r)for(var y=this.getAroundGapWidth(e),_=0,v=i.length;_<v;_++){var w=i[_];w.x+=0<_?i[_-1].x+i[_-1].width+y:.5*y}}},{key:"setJustifyContentForColumn",value:function(t){var e=this.height,i=this.childs,r=this.justifyContent;if(t&&(i=this.childs.reverse(),"flex-start"===r?r="flex-end":"flex-end"===r&&(r="flex-start")),"flex-start"===r)for(var n=0;n<i.length;n++){var s=i[n];s.y+=0<n?i[n-1].y+i[n-1].height:0}else if("flex-end"===r)for(var a=this.getChildsHeight(),h=0;h<i.length;h++){var o=i[h];o.y+=0<h?i[h-1].y+i[h-1].height:e-a}else if("center"===r)for(var l=this.getChildsHeight(),c=0;c<i.length;c++){var u=i[c];0<c?u.y+=i[c-1].y+i[c-1].height:u.y=.5*(e-l)}else if("space-between"===r)for(var d=this.getBetweenGapHeight(e),f=0,g=i.length;f<g;f++){var p=i[f];p.y+=0<f?i[f-1].y+i[f-1].height+d:0}else if("space-around"===r)for(var y=this.getAroundGapHeight(e),_=0,v=i.length;_<v;_++){var w=i[_];w.y+=0<_?i[_-1].y+i[_-1].height+y:.5*y}}},{key:"setAlignItemsByColumn",value:function(){var t=this.childs,e=this.width;if("center"===this.alignItems)for(var i=0,r=t.length;i<r;i++){var n=t[i];n.x+=.5*e-.5*n.width}else if("flex-start"===this.alignItems)for(var s=0,a=t.length;s<a;s++)t[s].x=0;else if("flex-end"===this.alignItems)for(var h=0,o=t.length;h<o;h++){var l=t[h];l.x+=e-l.width}t.forEach(function(t){"flex-start"===t.alignSelf?t.x=0:"center"===t.alignSelf?t.x=.5*e-.5*t.width:"flex-end"===t.alignSelf&&(t.x=e-t.width)})}},{key:"setColumn",value:function(){this.setJustifyContentForColumn(),this.setAlignItemsByColumn()}},{key:"setColumnReverse",value:function(){this.setJustifyContentForColumn(!0),this.setAlignItemsByColumn()}},{key:draw,value:function(t){var e=this.direction;"row"===e?this.setRow():"row-reverse"===e?this.setRowReverse():"column"===e?this.setColumn():"column-reverse"===e&&this.setColumnReverse(),this[extendsClassDraw](t)}}]),n}(),CreateLinearGradient=function(){function n(t,e,i,r){_classCallCheck(this,n),_defineProperty(this,"name","CreateLinearGradient"),_defineProperty(this,"colorStops",[]),this.x0=t,this.y0=e,this.x1=i,this.y1=r}return _createClass(n,[{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1],r=t.createLinearGradient(this.x0+e,this.y0+i,this.x1+e,this.y1+i);return this.colorStops.map(function(t){return r.addColorStop(t[0],t[1])}),r}},{key:"addColorStop",value:function(t,e){this.colorStops.push([t,e])}}]),n}(),CreateRadialGradient=function(){function a(t,e,i,r,n,s){_classCallCheck(this,a),_defineProperty(this,"name","CreateRadialGradient"),_defineProperty(this,"colorStops",[]),this.x0=t,this.y0=e,this.r0=i,this.x1=r,this.y1=n,this.r1=s}return _createClass(a,[{key:"create",value:function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return t.createRadialGradient?t.createRadialGradient.apply(this,i):(console.warn("小程序不支持传6个参数，请查阅: createCircularGradient 对应文档"),t.createCircularGradient.apply(this,i))}},{key:"exec",value:function(t,e){var i=_slicedToArray(e.getPosition(),2),e=i[0],i=i[1],r=this.create(t,this.x0+e,this.y0+i,this.r0,this.x1+e,this.y1+i,this.r1);return this.colorStops.map(function(t){return r.addColorStop(t[0],t[1])}),r}},{key:"addColorStop",value:function(t,e){this.colorStops.push([t,e])}}]),a}(),DuduCanvas={load:function(t){return new ImgLoader(t)},Stage:function(t,e,i){return new Stage(t,function(){e.apply(void 0,arguments)},i)},Shape:function(){return new Shape},Group:function(){return new Group},Text:function(t){return new Text(t)},Image:function(t){return new Image(t)},Sprite:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return _construct(Sprite,e)},color:{createLinearGradient:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return _construct(CreateLinearGradient,e)},createRadialGradient:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return _construct(CreateRadialGradient,e)}}};export{Container,CreateLinearGradient,CreateRadialGradient,DuduCanvas,Group,Image,ImgLoader,Shape,Sprite,Stage,Text};
